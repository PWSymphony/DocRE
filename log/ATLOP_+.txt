用“+”代替“*”
Using 16bit native Automatic Mixed Precision (AMP)
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
Global seed set to 0
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name    | Type      | Params
--------------------------------------
0 | model   | my_model3 | 120 M
1 | loss_fn | ATLoss    | 0
--------------------------------------
120 M     Trainable params
0         Non-trainable params
120 M     Total params
240.675   Total estimated model params size (MB)
{
    "seed": 0,
    "accelerator": "gpu",
    "accumulate_grad_batches": 1,
    "devices": [
        6,
        7
    ],
    "max_epochs": 30,
    "precision": 16,
    "log_every_n_steps": 200,
    "enable_checkpointing": true,
    "enable_progress_bar": false,
    "gradient_clip_val": 1,
    "checkpoint_dir": "./checkpoint",
    "save_name": "ATLOP_graph_1",
    "bert_type": "uncased",
    "data_path": "./data/with_graph",
    "batch_size": 2,
    "num_workers": 0,
    "is_zip": true,
    "log_print": true,
    "log_path": "./log/",
    "loss_fn": "ATL",
    "lr": 0.0001,
    "pre_lr": 5e-05,
    "warm_ratio": 0.06,
    "relation_num": 97,
    "result_dir": "./result",
    "model": "model3",
    "steps": 22905
}
step:  200 | epoch: 1 | loss:1.235536 | NA:88.28 | not NA:0.11 | total:85.83 | lr:7.24e-06
step:  400 | epoch: 1 | loss:0.706185 | NA:93.92 | not NA:5.13 | total:91.34 | lr:1.45e-05
step:  600 | epoch: 1 | loss:0.512520 | NA:95.75 | not NA:12.07 | total:93.32 | lr:2.18e-05
  all_F1:46.44  |  ign_F1:45.18  |  ign_theta_f1:  0.00
step:  800 | epoch: 2 | loss:0.097140 | NA:99.33 | not NA:41.10 | total:97.63 | lr:2.91e-05
step: 1000 | epoch: 2 | loss:0.100129 | NA:99.33 | not NA:38.70 | total:97.58 | lr:3.64e-05
step: 1200 | epoch: 2 | loss:0.102095 | NA:99.29 | not NA:40.59 | total:97.59 | lr:4.36e-05
step: 1400 | epoch: 2 | loss:0.104720 | NA:99.27 | not NA:40.47 | total:97.56 | lr:4.99e-05
  all_F1:45.84  |  ign_F1:44.62  |  ign_theta_f1:  0.00
step: 1600 | epoch: 3 | loss:0.093978 | NA:99.39 | not NA:45.06 | total:97.72 | lr:4.95e-05
step: 1800 | epoch: 3 | loss:0.095161 | NA:99.35 | not NA:46.89 | total:97.75 | lr:4.90e-05
step: 2000 | epoch: 3 | loss:0.091807 | NA:99.35 | not NA:47.67 | total:97.79 | lr:4.85e-05
step: 2200 | epoch: 3 | loss:0.091558 | NA:99.32 | not NA:48.23 | total:97.76 | lr:4.81e-05
  all_F1:53.30  |  ign_F1:50.93  |  ign_theta_f1:  0.00
step: 2400 | epoch: 4 | loss:0.071002 | NA:99.39 | not NA:55.68 | total:98.10 | lr:4.76e-05
step: 2600 | epoch: 4 | loss:0.072623 | NA:99.40 | not NA:56.46 | total:98.10 | lr:4.72e-05
step: 2800 | epoch: 4 | loss:0.077303 | NA:99.39 | not NA:56.00 | total:98.09 | lr:4.67e-05
step: 3000 | epoch: 4 | loss:0.077451 | NA:99.37 | not NA:56.63 | total:98.07 | lr:4.62e-05
  all_F1:55.39  |  ign_F1:53.63  |  ign_theta_f1:  0.00
step: 3200 | epoch: 5 | loss:0.060830 | NA:99.43 | not NA:65.80 | total:98.42 | lr:4.58e-05
step: 3400 | epoch: 5 | loss:0.064494 | NA:99.47 | not NA:63.16 | total:98.37 | lr:4.53e-05
step: 3600 | epoch: 5 | loss:0.063082 | NA:99.48 | not NA:63.38 | total:98.39 | lr:4.48e-05
step: 3800 | epoch: 5 | loss:0.062452 | NA:99.48 | not NA:63.24 | total:98.39 | lr:4.44e-05
  all_F1:55.90  |  ign_F1:54.14  |  ign_theta_f1:  0.00
step: 4000 | epoch: 6 | loss:0.053410 | NA:99.49 | not NA:70.86 | total:98.61 | lr:4.39e-05
step: 4200 | epoch: 6 | loss:0.051911 | NA:99.51 | not NA:69.88 | total:98.62 | lr:4.34e-05
step: 4400 | epoch: 6 | loss:0.053688 | NA:99.52 | not NA:69.53 | total:98.61 | lr:4.30e-05
  all_F1:56.51  |  ign_F1:54.52  |  ign_theta_f1:  0.00
step: 4600 | epoch: 7 | loss:0.046541 | NA:99.46 | not NA:69.58 | total:98.73 | lr:4.25e-05
step: 4800 | epoch: 7 | loss:0.043415 | NA:99.58 | not NA:74.25 | total:98.82 | lr:4.20e-05
step: 5000 | epoch: 7 | loss:0.041292 | NA:99.61 | not NA:74.38 | total:98.87 | lr:4.16e-05
step: 5200 | epoch: 7 | loss:0.042179 | NA:99.62 | not NA:74.34 | total:98.87 | lr:4.11e-05
  all_F1:58.03  |  ign_F1:56.23  |  ign_theta_f1:  0.00
step: 5400 | epoch: 8 | loss:0.032516 | NA:99.76 | not NA:74.62 | total:99.13 | lr:4.07e-05
step: 5600 | epoch: 8 | loss:0.035477 | NA:99.71 | not NA:78.61 | total:99.13 | lr:4.02e-05
step: 5800 | epoch: 8 | loss:0.035603 | NA:99.70 | not NA:78.67 | total:99.10 | lr:3.97e-05
step: 6000 | epoch: 8 | loss:0.036769 | NA:99.69 | not NA:77.82 | total:99.05 | lr:3.93e-05
  all_F1:57.47  |  ign_F1:55.40  |  ign_theta_f1:  0.00
step: 6200 | epoch: 9 | loss:0.030023 | NA:99.73 | not NA:83.42 | total:99.24 | lr:3.88e-05
step: 6400 | epoch: 9 | loss:0.031534 | NA:99.71 | not NA:82.56 | total:99.19 | lr:3.83e-05
step: 6600 | epoch: 9 | loss:0.031949 | NA:99.71 | not NA:82.31 | total:99.19 | lr:3.79e-05
step: 6800 | epoch: 9 | loss:0.032301 | NA:99.71 | not NA:82.16 | total:99.18 | lr:3.74e-05
  all_F1:57.82  |  ign_F1:55.96  |  ign_theta_f1:  0.00
step: 7000 | epoch:10 | loss:0.028540 | NA:99.74 | not NA:86.61 | total:99.32 | lr:3.69e-05
step: 7200 | epoch:10 | loss:0.029471 | NA:99.75 | not NA:86.78 | total:99.35 | lr:3.65e-05
step: 7400 | epoch:10 | loss:0.029442 | NA:99.77 | not NA:85.46 | total:99.33 | lr:3.60e-05
step: 7600 | epoch:10 | loss:0.028139 | NA:99.77 | not NA:85.58 | total:99.35 | lr:3.55e-05
  all_F1:58.61  |  ign_F1:56.86  |  ign_theta_f1:  0.00
step: 7800 | epoch:11 | loss:0.023565 | NA:99.81 | not NA:88.01 | total:99.46 | lr:3.51e-05
step: 8000 | epoch:11 | loss:0.023024 | NA:99.80 | not NA:88.16 | total:99.46 | lr:3.46e-05
step: 8200 | epoch:11 | loss:0.023913 | NA:99.79 | not NA:88.19 | total:99.44 | lr:3.42e-05
step: 8400 | epoch:11 | loss:0.024631 | NA:99.78 | not NA:87.93 | total:99.43 | lr:3.37e-05
  all_F1:58.80  |  ign_F1:56.55  |  ign_theta_f1:  0.00
step: 8600 | epoch:12 | loss:0.021820 | NA:99.81 | not NA:91.22 | total:99.54 | lr:3.32e-05
step: 8800 | epoch:12 | loss:0.022220 | NA:99.83 | not NA:89.76 | total:99.53 | lr:3.28e-05
step: 9000 | epoch:12 | loss:0.021724 | NA:99.83 | not NA:89.70 | total:99.53 | lr:3.23e-05
  all_F1:59.30  |  ign_F1:57.34  |  ign_theta_f1:  0.00
step: 9200 | epoch:13 | loss:0.018289 | NA:99.89 | not NA:89.50 | total:99.59 | lr:3.18e-05
step: 9400 | epoch:13 | loss:0.020358 | NA:99.86 | not NA:91.36 | total:99.60 | lr:3.14e-05
step: 9600 | epoch:13 | loss:0.020561 | NA:99.86 | not NA:91.52 | total:99.60 | lr:3.09e-05
step: 9800 | epoch:13 | loss:0.019551 | NA:99.86 | not NA:91.72 | total:99.62 | lr:3.04e-05
  all_F1:59.80  |  ign_F1:57.67  |  ign_theta_f1:  0.00
step:10000 | epoch:14 | loss:0.021448 | NA:99.87 | not NA:91.59 | total:99.61 | lr:3.00e-05
step:10200 | epoch:14 | loss:0.019516 | NA:99.85 | not NA:92.67 | total:99.64 | lr:2.95e-05
step:10400 | epoch:14 | loss:0.018219 | NA:99.87 | not NA:93.24 | total:99.68 | lr:2.90e-05
step:10600 | epoch:14 | loss:0.017323 | NA:99.88 | not NA:93.34 | total:99.69 | lr:2.86e-05
  all_F1:59.59  |  ign_F1:57.66  |  ign_theta_f1:  0.00
step:10800 | epoch:15 | loss:0.015342 | NA:99.91 | not NA:95.59 | total:99.77 | lr:2.81e-05
step:11000 | epoch:15 | loss:0.015503 | NA:99.90 | not NA:94.40 | total:99.73 | lr:2.76e-05
step:11200 | epoch:15 | loss:0.014832 | NA:99.90 | not NA:94.55 | total:99.74 | lr:2.72e-05
step:11400 | epoch:15 | loss:0.014863 | NA:99.90 | not NA:94.49 | total:99.74 | lr:2.67e-05
  all_F1:59.33  |  ign_F1:56.95  |  ign_theta_f1:  0.00
step:11600 | epoch:16 | loss:0.014335 | NA:99.91 | not NA:94.16 | total:99.75 | lr:2.63e-05
step:11800 | epoch:16 | loss:0.014770 | NA:99.91 | not NA:94.35 | total:99.75 | lr:2.58e-05
step:12000 | epoch:16 | loss:0.014518 | NA:99.92 | not NA:94.59 | total:99.76 | lr:2.53e-05
step:12200 | epoch:16 | loss:0.014285 | NA:99.92 | not NA:94.75 | total:99.76 | lr:2.49e-05
  all_F1:59.31  |  ign_F1:57.20  |  ign_theta_f1:  0.00
step:12400 | epoch:17 | loss:0.013299 | NA:99.95 | not NA:96.09 | total:99.83 | lr:2.44e-05
step:12600 | epoch:17 | loss:0.012688 | NA:99.93 | not NA:96.49 | total:99.83 | lr:2.39e-05
step:12800 | epoch:17 | loss:0.012545 | NA:99.93 | not NA:96.28 | total:99.82 | lr:2.35e-05
  all_F1:59.90  |  ign_F1:57.68  |  ign_theta_f1:  0.00
step:13000 | epoch:18 | loss:0.008124 | NA:99.89 | not NA:98.52 | total:99.86 | lr:2.30e-05
step:13200 | epoch:18 | loss:0.013151 | NA:99.94 | not NA:96.36 | total:99.84 | lr:2.25e-05
step:13400 | epoch:18 | loss:0.012396 | NA:99.94 | not NA:96.42 | total:99.84 | lr:2.21e-05
step:13600 | epoch:18 | loss:0.012119 | NA:99.94 | not NA:96.44 | total:99.83 | lr:2.16e-05
  all_F1:60.14  |  ign_F1:58.07  |  ign_theta_f1:  0.00
step:13800 | epoch:19 | loss:0.014615 | NA:99.94 | not NA:96.65 | total:99.83 | lr:2.11e-05
step:14000 | epoch:19 | loss:0.012431 | NA:99.95 | not NA:97.20 | total:99.86 | lr:2.07e-05
step:14200 | epoch:19 | loss:0.011464 | NA:99.95 | not NA:97.25 | total:99.87 | lr:2.02e-05
step:14400 | epoch:19 | loss:0.010775 | NA:99.95 | not NA:97.40 | total:99.88 | lr:1.98e-05
  all_F1:59.90  |  ign_F1:57.87  |  ign_theta_f1:  0.00
step:14600 | epoch:20 | loss:0.010511 | NA:99.97 | not NA:97.15 | total:99.89 | lr:1.93e-05
step:14800 | epoch:20 | loss:0.010558 | NA:99.97 | not NA:97.65 | total:99.90 | lr:1.88e-05
step:15000 | epoch:20 | loss:0.009898 | NA:99.96 | not NA:97.95 | total:99.91 | lr:1.84e-05
step:15200 | epoch:20 | loss:0.009896 | NA:99.97 | not NA:97.94 | total:99.91 | lr:1.79e-05
  all_F1:60.30  |  ign_F1:58.17  |  ign_theta_f1:  0.00
step:15400 | epoch:21 | loss:0.008962 | NA:99.97 | not NA:98.25 | total:99.93 | lr:1.74e-05
step:15600 | epoch:21 | loss:0.009315 | NA:99.97 | not NA:98.14 | total:99.92 | lr:1.70e-05
step:15800 | epoch:21 | loss:0.009646 | NA:99.97 | not NA:98.15 | total:99.91 | lr:1.65e-05
step:16000 | epoch:21 | loss:0.009343 | NA:99.97 | not NA:98.12 | total:99.91 | lr:1.60e-05
  all_F1:60.12  |  ign_F1:58.24  |  ign_theta_f1:  0.00
step:16200 | epoch:22 | loss:0.007604 | NA:99.98 | not NA:98.58 | total:99.94 | lr:1.56e-05
step:16400 | epoch:22 | loss:0.007766 | NA:99.97 | not NA:98.41 | total:99.93 | lr:1.51e-05
step:16600 | epoch:22 | loss:0.008372 | NA:99.97 | not NA:98.44 | total:99.93 | lr:1.46e-05
step:16800 | epoch:22 | loss:0.008293 | NA:99.97 | not NA:98.48 | total:99.93 | lr:1.42e-05
  all_F1:60.66  |  ign_F1:58.50  |  ign_theta_f1:  0.00
step:17000 | epoch:23 | loss:0.007882 | NA:99.97 | not NA:98.73 | total:99.93 | lr:1.37e-05
step:17200 | epoch:23 | loss:0.007722 | NA:99.98 | not NA:98.83 | total:99.94 | lr:1.33e-05
step:17400 | epoch:23 | loss:0.007573 | NA:99.98 | not NA:98.84 | total:99.95 | lr:1.28e-05
  all_F1:60.33  |  ign_F1:58.32  |  ign_theta_f1:  0.00
step:17600 | epoch:24 | loss:0.005731 | NA:99.99 | not NA:98.68 | total:99.95 | lr:1.23e-05
step:17800 | epoch:24 | loss:0.007187 | NA:99.98 | not NA:98.98 | total:99.95 | lr:1.19e-05
step:18000 | epoch:24 | loss:0.006812 | NA:99.98 | not NA:99.14 | total:99.96 | lr:1.14e-05
step:18200 | epoch:24 | loss:0.006794 | NA:99.99 | not NA:99.12 | total:99.96 | lr:1.09e-05
  all_F1:60.47  |  ign_F1:58.52  |  ign_theta_f1:  0.00
step:18400 | epoch:25 | loss:0.007680 | NA:99.98 | not NA:99.27 | total:99.96 | lr:1.05e-05
step:18600 | epoch:25 | loss:0.006754 | NA:99.99 | not NA:99.41 | total:99.97 | lr:1.00e-05
step:18800 | epoch:25 | loss:0.006798 | NA:99.99 | not NA:99.34 | total:99.97 | lr:9.54e-06
step:19000 | epoch:25 | loss:0.006801 | NA:99.99 | not NA:99.40 | total:99.97 | lr:9.07e-06
  all_F1:60.67  |  ign_F1:58.66  |  ign_theta_f1:  0.00
step:19200 | epoch:26 | loss:0.006954 | NA:100.00 | not NA:99.62 | total:99.99 | lr:8.61e-06
step:19400 | epoch:26 | loss:0.006705 | NA:99.99 | not NA:99.66 | total:99.98 | lr:8.14e-06
step:19600 | epoch:26 | loss:0.006283 | NA:99.99 | not NA:99.58 | total:99.98 | lr:7.68e-06
step:19800 | epoch:26 | loss:0.006235 | NA:99.99 | not NA:99.62 | total:99.98 | lr:7.21e-06
  all_F1:60.73  |  ign_F1:58.72  |  ign_theta_f1:  0.00
step:20000 | epoch:27 | loss:0.005461 | NA:100.00 | not NA:99.72 | total:99.99 | lr:6.75e-06
step:20200 | epoch:27 | loss:0.005197 | NA:99.99 | not NA:99.77 | total:99.99 | lr:6.28e-06
step:20400 | epoch:27 | loss:0.005454 | NA:99.99 | not NA:99.74 | total:99.99 | lr:5.82e-06
step:20600 | epoch:27 | loss:0.005557 | NA:99.99 | not NA:99.69 | total:99.99 | lr:5.36e-06
  all_F1:60.79  |  ign_F1:58.84  |  ign_theta_f1:  0.00
step:20800 | epoch:28 | loss:0.004757 | NA:100.00 | not NA:99.70 | total:99.99 | lr:4.89e-06
step:21000 | epoch:28 | loss:0.005507 | NA:99.99 | not NA:99.69 | total:99.99 | lr:4.43e-06
step:21200 | epoch:28 | loss:0.005755 | NA:100.00 | not NA:99.73 | total:99.99 | lr:3.96e-06
  all_F1:61.07  |  ign_F1:59.13  |  ign_theta_f1:  0.00
step:21400 | epoch:29 | loss:0.003593 | NA:100.00 | not NA:100.00 | total:100.00 | lr:3.50e-06
step:21600 | epoch:29 | loss:0.005175 | NA:100.00 | not NA:99.87 | total:100.00 | lr:3.03e-06
step:21800 | epoch:29 | loss:0.005233 | NA:100.00 | not NA:99.84 | total:99.99 | lr:2.57e-06
step:22000 | epoch:29 | loss:0.005005 | NA:100.00 | not NA:99.86 | total:99.99 | lr:2.10e-06
  all_F1:61.05  |  ign_F1:59.08  |  ign_theta_f1:  0.00
step:22200 | epoch:30 | loss:0.005110 | NA:100.00 | not NA:100.00 | total:100.00 | lr:1.64e-06
step:22400 | epoch:30 | loss:0.004351 | NA:100.00 | not NA:99.89 | total:100.00 | lr:1.18e-06
step:22600 | epoch:30 | loss:0.004414 | NA:100.00 | not NA:99.85 | total:99.99 | lr:7.11e-07
step:22800 | epoch:30 | loss:0.004729 | NA:100.00 | not NA:99.87 | total:99.99 | lr:2.46e-07
  all_F1:61.13  |  ign_F1:59.17  |  ign_theta_f1:  0.00
